* Encuentra el mayor producto de cinco dígitos consecutivos en este número de 1000 dígitos.

#INCLUDE "Hbgtinfo.ch"

HB_GTINFO(HB_GTI_WINTITLE, "Problema 08")
SETMODE(25,80)
SET CURSOR OFF
CLEAR

PRIVATE cNum AS NUMERIC
PRIVATE cElem AS NUMERIC
PRIVATE aRes AS NUMERIC
PRIVATE nAux AS NUMERIC
PRIVATE nMaxPos AS NUMERIC
PRIVATE nMaxRes := 0
PRIVATE sNumIng := ""
PRIVATE vNumIng[20]

vNumIng[1] = "73167176531330624919225119674426574742355349194934"
vNumIng[2] = "96983520312774506326239578318016984801869478851843"
vNumIng[3] = "85861560789112949495459501737958331952853208805511"
vNumIng[4] = "12540698747158523863050715693290963295227443043557"
vNumIng[5] = "66896648950445244523161731856403098711121722383113"
vNumIng[6] = "62229893423380308135336276614282806444486645238749"
vNumIng[7] = "30358907296290491560440772390713810515859307960866"
vNumIng[8] = "70172427121883998797908792274921901699720888093776"
vNumIng[9] = "65727333001053367881220235421809751254540594752243"
vNumIng[10] = "52584907711670556013604839586446706324415722155397"
vNumIng[11] = "53697817977846174064955149290862569321978468622482"
vNumIng[12] = "83972241375657056057490261407972968652414535100474"
vNumIng[13] = "82166370484403199890008895243450658541227588666881"
vNumIng[14] = "16427171479924442928230863465674813919123162824586"
vNumIng[15] = "17866458359124566529476545682848912883142607690042"
vNumIng[16] = "24219022671055626321111109370544217506941658960408"
vNumIng[17] = "07198403850962455444362981230987879927244284909188"
vNumIng[18] = "84580156166097919133875499200524063689912560717606"
vNumIng[19] = "05886116467109405077541002256983155200055935729725"
vNumIng[20] = "71636269561882670428252483600823257530420752963450"

FOR cElem := 1 TO 20
	sNumIng += vNumIng[cElem]
NEXT

FOR cElem := 1 TO 996
	aRes = 1
	FOR cNum := cElem TO (cElem + 4)
		nAux = VAL(SUBSTR(sNumIng,cNum,1))
		aRes *= nAux
	NEXT
	IF aRes > nMaxRes
		nMaxRes = aRes
		nMaxPos = cElem
	ENDIF
NEXT

@ 6,2 SAY "El resultado es " + NUMTRIM(nMaxRes) + " y empieza en la posicion " + NUMTRIM(nMaxPos)
INKEY(0)
CLEAR




FUNCTION NUMTRIM(pnNum)
	pnNum = LTRIM(STR(INT(pnNum)))
RETURN pnNum
